{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/ewt-all-in-one-1/Desktop/Chat-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/ewt-all-in-one-1/Desktop/Chat-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/ewt-all-in-one-1/Desktop/Chat-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from\"react\";import\"react-responsive-modal/styles.css\";import{Modal}from\"react-responsive-modal\";import{auth,db}from\"../firebase\";import{addDoc,collection,doc,getDoc,onSnapshot,orderBy,query,Timestamp}from\"firebase/firestore\";import Moment from\"react-moment\";import Img from\"../image1.jpg\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ClickModel=function ClickModel(){var scrool=useRef();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),message=_useState4[0],setMessage=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),chat=_useState6[0],setChat=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),user=_useState8[0],setUser=_useState8[1];var onOpenModal=function onOpenModal(){return setOpen(true);};var onCloseModal=function onCloseModal(){return setOpen(false);};var userDetailsChat=JSON.parse(localStorage.getItem(\"os-user\"));var user1=auth.currentUser.uid;var users=auth.onAuthStateChanged(function(user){console.log(user.uid);});var clientId=localStorage.getItem(\"id\");var user2=clientId;var id=user1>user2?\"\".concat(user1+user2):\"\".concat(user2+user1);useEffect(function(){getDoc(doc(db,\"users\",auth.currentUser.uid)).then(function(docSnap){if(docSnap.exists){setUser(docSnap.data());}});},[]);useEffect(function(){var _scrool$current;(_scrool$current=scrool.current)===null||_scrool$current===void 0?void 0:_scrool$current.scrollIntoView({behavior:\"smooth\"});},[message]);useEffect(function(){var msgsRef=collection(db,\"messages\",id,\"chat\");var q=query(msgsRef,orderBy(\"createdAt\",\"asc\"));onSnapshot(q,function(querySnapshot){var msgs=[];querySnapshot.forEach(function(doc){msgs.push(doc.data());console.log(doc.data());});setChat(msgs);});},[]);var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.next=3;return addDoc(collection(db,\"messages\",id,\"chat\"),{message:message,from:user1,to:user1,createdAt:Timestamp.fromDate(new Date()),// senderName: userDetailsChat.name,\nsenderGmail:userDetailsChat.email});case 3:setMessage(\"\");case 4:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[open===true?/*#__PURE__*/_jsx(Modal,{open:open,onClose:onCloseModal,classNames:{modal:\"message-pop-model\"},center:true,children:/*#__PURE__*/_jsxs(\"div\",{className:\"chat-model-size\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-model-size-img\",children:[/*#__PURE__*/_jsx(\"img\",{src:Img,alt:\"img\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-model-size-status\",children:[/*#__PURE__*/_jsx(\"p\",{children:user&&user.name}),/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(Moment,{fromNow:true,children:user&&user.createdAt.toDate()})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-model-size-height\",children:chat&&chat.map(function(data,i){return/*#__PURE__*/_jsxs(\"div\",{className:user1?\"chat-model-size-client-model\":\"chat-model-size-help-model\",style:{position:\"relative\"},ref:scrool,children:[/*#__PURE__*/_jsx(\"p\",{children:data.message}),/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(Moment,{fromNow:true,children:data.createdAt.toDate()})})]},i);})}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-model-size-position\",children:/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(\"div\",{className:\"chat-model-size-input d-flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"chat-model-size-input-i\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Say something\",value:message,onInput:function onInput(e){return setMessage(e.target.value);}})}),/*#__PURE__*/_jsx(\"div\",{className:\"\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:!message,children:\"Send\"})})]})})})]})}):/*#__PURE__*/_jsxs(\"div\",{className:\"app\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"open-btn-dot\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"open-btn\",onClick:onOpenModal,children:\"CHAT NOW\"})]}),open?/*#__PURE__*/_jsx(\"div\",{className:\"close-model\",onClick:onCloseModal,children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-close\"})}):\"\"]});};export default ClickModel;//     \"chat-model-size-client\"\n// \"chat-model-size-help\"","map":{"version":3,"sources":["C:/Users/ewt-all-in-one-1/Desktop/Chat-app/src/pages/ClickModel.js"],"names":["React","useState","useEffect","useRef","Modal","auth","db","addDoc","collection","doc","getDoc","onSnapshot","orderBy","query","Timestamp","Moment","Img","ClickModel","scrool","open","setOpen","message","setMessage","chat","setChat","user","setUser","onOpenModal","onCloseModal","userDetailsChat","JSON","parse","localStorage","getItem","user1","currentUser","uid","users","onAuthStateChanged","console","log","clientId","user2","id","then","docSnap","exists","data","current","scrollIntoView","behavior","msgsRef","q","querySnapshot","msgs","forEach","push","handleSubmit","e","preventDefault","from","to","createdAt","fromDate","Date","senderGmail","email","modal","name","toDate","map","i","position","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport \"react-responsive-modal/styles.css\";\r\nimport { Modal } from \"react-responsive-modal\";\r\nimport { auth, db } from \"../firebase\";\r\nimport {\r\n  addDoc,\r\n  collection,\r\n  doc,\r\n  getDoc,\r\n  onSnapshot,\r\n  orderBy,\r\n  query,\r\n  Timestamp,\r\n} from \"firebase/firestore\";\r\nimport Moment from \"react-moment\";\r\nimport Img from \"../image1.jpg\";\r\nconst ClickModel = () => {\r\n  const scrool = useRef();\r\n\r\n  const [open, setOpen] = useState(false);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [chat, setChat] = useState([]);\r\n  const [user, setUser] = useState();\r\n\r\n  const onOpenModal = () => setOpen(true);\r\n  const onCloseModal = () => setOpen(false);\r\n  const userDetailsChat = JSON.parse(localStorage.getItem(\"os-user\"));\r\n\r\n  const user1 = auth.currentUser.uid;\r\n  const users = auth.onAuthStateChanged((user) => {\r\n    console.log(user.uid);\r\n  });\r\n\r\n  const clientId = localStorage.getItem(\"id\");\r\n\r\n  const user2 = clientId;\r\n  const id = user1 > user2 ? `${user1 + user2}` : `${user2 + user1}`;\r\n\r\n  useEffect(() => {\r\n    getDoc(doc(db, \"users\", auth.currentUser.uid)).then((docSnap) => {\r\n      if (docSnap.exists) {\r\n        setUser(docSnap.data());\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    scrool.current?.scrollIntoView({ behavior: \"smooth\" });\r\n  }, [message]);\r\n\r\n  useEffect(() => {\r\n    const msgsRef = collection(db, \"messages\", id, \"chat\");\r\n    const q = query(msgsRef, orderBy(\"createdAt\", \"asc\"));\r\n\r\n    onSnapshot(q, (querySnapshot) => {\r\n      let msgs = [];\r\n      querySnapshot.forEach((doc) => {\r\n        msgs.push(doc.data());\r\n        console.log(doc.data());\r\n      });\r\n      setChat(msgs);\r\n    });\r\n  }, []);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    await addDoc(collection(db, \"messages\", id, \"chat\"), {\r\n      message,\r\n      from: user1,\r\n      to: user1,\r\n      createdAt: Timestamp.fromDate(new Date()),\r\n      // senderName: userDetailsChat.name,\r\n      senderGmail: userDetailsChat.email,\r\n    });\r\n    setMessage(\"\");\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {open === true ? (\r\n        <Modal\r\n          open={open}\r\n          onClose={onCloseModal}\r\n          classNames={{ modal: \"message-pop-model\" }}\r\n          center\r\n        >\r\n          <div className=\"chat-model-size\">\r\n            <div className=\"chat-model-size-img\">\r\n              <img src={Img} alt=\"img\" />\r\n              <div className=\"chat-model-size-status\">\r\n                <p>{user && user.name}</p>\r\n                <span>\r\n                  <Moment fromNow>{user && user.createdAt.toDate()}</Moment>\r\n                </span>\r\n              </div>\r\n            </div>\r\n            <div className=\"chat-model-size-height\">\r\n              {chat &&\r\n                chat.map((data, i) => (\r\n                  <div\r\n                    key={i}\r\n                    className={\r\n                      user1\r\n                        ? \"chat-model-size-client-model\"\r\n                        : \"chat-model-size-help-model\"\r\n                    }\r\n                    style={{ position: \"relative\" }}\r\n                    ref={scrool}\r\n                  >\r\n                    <p>{data.message}</p>\r\n                    <span>\r\n                      <Moment fromNow>{data.createdAt.toDate()}</Moment>\r\n                    </span>\r\n                  </div>\r\n                ))}\r\n            </div>\r\n\r\n            <div className=\"chat-model-size-position\">\r\n              <form onSubmit={handleSubmit}>\r\n                <div className=\"chat-model-size-input d-flex\">\r\n                  <div className=\"chat-model-size-input-i\">\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"Say something\"\r\n                      value={message}\r\n                      onInput={(e) => setMessage(e.target.value)}\r\n                    />\r\n                  </div>\r\n                  <div className=\"\">\r\n                    <button type=\"submit\" disabled={!message}>\r\n                      Send\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        </Modal>\r\n      ) : (\r\n        <div className=\"app\">\r\n          <div className=\"open-btn-dot\"></div>\r\n          <button type=\"button\" className=\"open-btn\" onClick={onOpenModal}>\r\n            CHAT NOW\r\n          </button>\r\n        </div>\r\n      )}\r\n      {open ? (\r\n        <div className=\"close-model\" onClick={onCloseModal}>\r\n          <i className=\"fa fa-close\"></i>\r\n        </div>\r\n      ) : (\r\n        \"\"\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ClickModel;\r\n\r\n//     \"chat-model-size-client\"\r\n// \"chat-model-size-help\"\r\n"]},"metadata":{},"sourceType":"module"}